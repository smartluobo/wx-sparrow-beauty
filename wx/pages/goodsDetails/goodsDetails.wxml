<import src="../../wxParse/wxParse.wxml" />
<view class="error" wx:if="{{errMsg}}">
    <view></view>
    <text>商品信息错误！该商品已下架</text>
</view>
<view class="goTop" bindtap="goTop" wx:if="{{top>800}}"></view>
<scroll-view class="container" scroll-y="{{isScroll}}" bindscroll="scroll" wx:if="{{!errMsg&&detailsShow}}" scroll-top="{{scrollTop}}">
    <view class="bannerBox">
        <view class="share" bindtap="goHome">首 页</view>
        <swiper class="banner" indicator-active-color="#ff5e6b" indicator-color="#FFAFB5" indicator-dots="{{indicatorDots}}" display-multiple-items interval="{{interval}}" duration="{{duration}}">
            <block wx:for="{{imgUrls}}" wx:key="{{index}}">
                <swiper-item>
                    <image src="{{item}}" class="slide-image" width="355" height="150" />
                </swiper-item>
            </block>
        </swiper>
    </view>
    <view class="activity" wx:if="{{details.activityCode}}" bindtap="goActivity">
        <view class="activityLeft">
            <view class="activityTag2">{{details.activityTag}}{{details.activityCode.slice(0, 3)}}</view>
            <view class="activityR">
                <view class="activityrule" wx:if="{{details.activityRule}}">
                    {{details.activityRule}}
                </view>
                <view class="activityTime" wx:if="{{isXSG}}">
                    <view>{{globalTimer}}</view>
                </view>
            </view>
            <view class="gogogo">
                <view></view>
            </view>
        </view>
    </view>
    <view class="goods_detail border_bottom">
        <view class="goods_name_box">
            <view class="goods_name">{{details.name}}</view>
            <view class="useCoupon" wx:if="{{details.allowCoupon==1}}" bindtap="noway">
                <image src="/image/noway.png" />
            </view>
        </view>
        <view class="goods_person_price_box">
            <view class="goods_person_price f-left" wx:if="{{!isXSGBegin}}">
                <view class="gpp_group_price_f">{{details.activitypriceDesc}}¥</view>
                <view class="gpp_group_price_l">{{webNewPrice}}<text wx:if="{{priceScope}}">起</text></view>
                <view class="gpp_market_price">市场参考价¥{{details.marketPrice}}</view>
            </view>
            <view class="goods_person_price f-left" wx:if="{{isXSGBegin}}">
                <view class="gpp_group_price_f">¥</view>
                <view class="gpp_group_price_l">{{webNewPrice}}<text wx:if="{{priceScope}}">起</text></view>
                <view class="gpp_market_price">{{details.activitypriceDesc}}¥<text>{{details.activityPrice}}</text>(未开始)</view>
            </view>
            <view class="prop_label f-right" bind:tap="Intergral">
                <view class="prop_label_icon"></view>
                <view class="prop_label_text">
                    <view>{{details.buyIntergral}}</view>
                    积分
                </view>
                <view class="prop_label_qus"></view>
            </view>
        </view>
        <view class="goodsTag">
            <view class="activityLabel" wx:if="{{details.activityCode}}" bindtap="goActivity" data-id="{{details.activityCode}}">{{details.activityTag}}></view>
            <view class="activityLabelSBox" wx:for="{{details.marketLabelList}}" wx:key="index" wx:for-item="label">
                <text class="activityLabelS"  bindtap="goLabelActivity" data-id="{{label.id}}">{{label.title}}></text>
            </view>
        </view>
    </view>
    <view class="couponList" wx:if="{{details.couponJson.length>0}}">
        <text>【优惠券】</text>
        <view class="coupon_l" wx:for="{{details.couponJson}}" wx:for-item="coupon" wx:key="index">
            {{coupon.coupon_name}}
            <view class="getCoupon" bindtap="getCoupon" data-id="{{coupon.id}}">领取</view>
        </view>
    </view>
    <view class="prop_sku" bindtap="showModal" wx:if="{{details.skuSale.length>1}}">
        <view class="prop_sku_text" wx:if="{{selectName.length>=1}}">已选：{{selectName}}</view>
        <view class="prop_sku_text" wx:if="{{selectName.length<1}}">选择商品属性</view>
    </view>
    <view class="group_comment" wx:if="{{Evaluate}}">
        <view class="gc_head" bindtap="allEvaluate">
            <view class="gc_head_l">Ta们在说({{evaluateCount}})</view>
            <view class="gc_head_r">查看更多评论</view>
        </view>
        <view class="gc_cnt">
            <view class="comment_list" wx:for="{{Evaluate}}" wx:for-item="eval" wx:key="index">
                <view class="cl_head">
                    <image src="{{eval.avatar}}"></image>
                    <view class="cl_head_name">
                        <view>{{eval.nickname}}</view>
                    </view>
                    <view class="cl_head_star_like">
                        <view class="comment_star">
                            <view wx:for="{{eval.star}}" wx:for-item="item" wx:key="index"></view>
                        </view>
                    </view>
                </view>
                <view class="cl_text">{{eval.content}}</view>
                <view class="cl_img" wx:if="{{eval.images}}">
                    <view class="cl_img_s" wx:for="{{eval.images}}" wx:for-item="item" wx:key="index">
                        <view wx:if="{{item}}" class="list-dImg">
                            <image bindtap="imgYu" data-list="{{eval.images}}" data-src="{{item}}" src="{{item}}"></image>
                        </view>
                    </view>
                </view>
            </view>
        </view>
    </view>
    <view class="goods_pic_art">
        <view class="goods_pic_art_tab border_bottom">
            <view class="goods_tab" id="detailTab">
                <span class="">商品详情</span>
            </view>
        </view>
        <view class="wxParse">
            <template is="wxParse" id="detail" data="{{wxParseData:itemBody.nodes}}"></template>
        </view>
        <view class="goods_pic_art_tab">
            <view class="goods_tab" id="promiseTab">
                <span class="">服务承诺</span>
            </view>
        </view>
        <view class="goods_pic_art_cot">
            <view class="wxParse">
                <template is="wxParse" id="promise" data="{{wxParseData:service_promise.nodes}}"></template>
            </view>
        </view>
    </view>
</scroll-view>
<view class="sku_foot">
    <view class="sku_like" bindtap='goCart'>
        <view></view>
        <text>购物车</text>
    </view>
    <button class="sku_service" size="40" show-message-card="true" open-type="contact" send-message-title="{{details.name}}" session-from="nickName={{nickname}}|avatarUrl={{avatar}}|referrerTitle={{ysf.title}}|ysf.config= {{ysf.config}}">
        <view></view>
        <text>客服</text>
    </button>
    <view class="{{details.quantity>0?'sku_add_cart':'sku_add_cart_not'}}" data-status="{{details.quantity>0?'0':'1'}}" bindtap='_addCart'>
        <text>加入购物车</text>
    </view>
    <view class="{{details.quantity>0?'sku_shopping':'sku_shopping_not'}}" data-status="{{details.quantity>0?'0':'1'}}"  wx:if="{{!details.sellStatus}}" bindtap='_promptly'>
        <text>立即购买</text> 
    </view>
    <view class="sku_shopping_s sku_shopping" wx:if="{{details.sellStatus}}">
        <text>待售</text>
    </view>
</view>
<!-- 屏幕背景变暗的背景 -->
<view class="commodity_screen" bindtap="hideModal" wx:if="{{showModalStatus}}"></view>
<!-- 弹出框 -->
<view animation="{{animationData}}" class="commodity_attr_box" wx:if="{{showModalStatus}}">
 <!-- <selectSku id="{{id}}"></selectSku> -->
    <view class="sku_detail">
        <view class="sku_img">
            <view wx:if="{{skuImg}}" class="list-dImg">
                <image bindtap="imgsku" data-list="{{skuImgList}}" data-src="{{skuImg}}" src="{{skuImg}}"></image>
            </view>
        </view>
        <view class="sku_name">{{details.name}}</view>
        <view class="sku_price">￥{{skuPrice}}</view>
        <view class="sku_repertory">
            <text>库存：{{repertory}}</text>
        </view>
    </view>
    <view class="sku_box">
        <view class="sku_pro" id="panel_sel">
            <view class="sku_list goods_attr" wx:for="{{details.props}}" wx:key="item" wx:for-item="prop" wx:for-index="group_idx">
                <view class="sku_title label">{{prop.propName}}</view>
                <view class="sku_check">
                    <button wx:if="{{prop.propId==propval.propId}}" wx:for="{{propvalues}}" data-prop-name="{{prop.propName}}" 
                    data-select-index="{{group_idx}}" data-img="{{propval.propValueUrl}}" wx:key="{{index}}" data-attr-index="{{index}}"
                     data-prop-val-name="{{propval.propValueName}}" wx:for-item="propval" disabled="{{propval._isDisable}}"
                     class="{{propval.propClass?'sku_active goods_sku':' goods_sku'}}" data-prop="{{propval}}"
                      data-prop-val-id="{{propval.propValueId}}" data-prop-id="{{propval.propId}}" catchtap="selectProp">
                        {{propval.propValueName}}
                    </button>
                </view>
            </view>
        </view>
        <view class="sku_qua">
            <view class="sku_qua_box">
                购买数量
                <view class="sku_qua_operation">
                    <view class="sku_qua_sub" bindtap="subCount"></view>
                    <view class="sku_qua_nmb">{{showCount}}</view>
                    <view class="sku_qua_add" bindtap="addCount"></view>
                </view>
            </view>
        </view>
    </view>
    <view class="sku_foot_s">
        <view class="addCart" bindtap='addCart'>
            <text>加入购物车</text>
        </view>
        <view class="shopNow" bindtap='shopNow'>
            <text>立即购买</text>
        </view>
    </view>
</view>